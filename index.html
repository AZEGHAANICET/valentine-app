<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VALENTINE TERMINAL</title>

<style>
:root{
  --terminal-green:#00ff41;
  --terminal-bg:#050b05;
  --terminal-red:#ff3131;
  --accent:var(--terminal-green);
}
*{box-sizing:border-box;}
html,body{
  margin:0;height:100%;
  background:var(--terminal-bg);
  color:var(--accent);
  font-family:"Courier New",monospace;
}
.scanlines{
  position:fixed;inset:0;
  background:linear-gradient(rgba(0,0,0,0) 50%,rgba(0,0,0,.12) 50%);
  background-size:100% 3px;
  pointer-events:none;
}
#terminal{padding:20px;font-size:16px;text-shadow:0 0 5px var(--accent);}
.input-line{display:flex;margin-top:15px}
#user-input{
  background:transparent;border:none;color:#fff;
  font-family:inherit;outline:none;width:100%;
}
.cursor{width:8px;background:var(--accent);animation:blink .8s infinite}
@keyframes blink{50%{opacity:0}}
.hidden{display:none}
.error{color:var(--terminal-red)}

#final-screen{
  display:none;position:fixed;inset:0;
  background:#000;
  justify-content:center;
  align-items:center;
  flex-direction:column;
  text-align:center;
  opacity:0;
  transition:opacity 1s;
}

.heart-ascii{
  color:var(--terminal-red);
  white-space:pre;
  font-size:8px;
}

#custom-message{
  opacity:0;
  transform:translateY(15px);
  color:#eee;
  margin:25px;
  font-size:1.15rem;
  line-height:1.7;
  animation:fadeInUp 1.2s ease forwards;
}

#quote{
  margin-top:30px;
  max-width:600px;
  opacity:0;
  font-style:italic;
  color:#ccc;
  animation:fadeQuote 2s ease forwards;
  animation-delay:1.5s;
}

#author{
  margin-top:8px;
  font-size:.9rem;
  color:#888;
}

@keyframes fadeInUp{to{opacity:1;transform:translateY(0)}}
@keyframes fadeQuote{to{opacity:1}}

.pulse{animation:pulse 3s ease-in-out infinite}
@keyframes pulse{
  0%{text-shadow:0 0 6px rgba(255,255,255,.2)}
  50%{text-shadow:0 0 14px rgba(255,255,255,.6)}
  100%{text-shadow:0 0 6px rgba(255,255,255,.2)}
}

.btn{
  margin-top:35px;
  background:transparent;
  border:1px solid #ff4d6d;
  color:white;
  padding:12px 30px;
  cursor:pointer;
}
</style>
</head>

<body>
<div class="scanlines"></div>

<div id="terminal" onclick="userInput.focus()">
  <div id="output"></div>
  <div id="input-area" class="input-line hidden">
    <span>&gt; </span>
    <input id="user-input" autocomplete="off">
    <span class="cursor"></span>
  </div>
</div>

<div id="final-screen">
<div class="heart-ascii">
*** ***
******* *******
*****************
*****************
 ***************
   ***********
     *******
       ***
        *
</div>

<div id="custom-message"></div>

<div id="quote">
  ‚Äú<span id="quote-text"></span>‚Äù
  <div id="author">‚Äî <span id="quote-author"></span></div>
</div>

<button class="btn" onclick="celebrate()">[ ‚ù§Ô∏è ]</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const output=document.getElementById("output");
const userInput=document.getElementById("user-input");
const inputArea=document.getElementById("input-area");
const finalScreen=document.getElementById("final-screen");

let step="NAME", userName="", selectedRelation=null, meetingPlace="";

// fonction al√©atoire
const random=a=>a[Math.floor(Math.random()*a.length)];

// citations philosophiques
const QUOTES=[
 {q:"Aimer, ce n‚Äôest pas se regarder l‚Äôun l‚Äôautre, c‚Äôest regarder ensemble dans la m√™me direction.",a:"Antoine de Saint-Exup√©ry"},
 {q:"Le c≈ìur a ses raisons que la raison ne conna√Æt point.",a:"Blaise Pascal"},
 {q:"Ce n‚Äôest pas le temps qui fait les liens, c‚Äôest la pr√©sence.",a:"S√©n√®que"},
 {q:"On ne rencontre jamais les gens par hasard.",a:"Carl Gustav Jung"},
 {q:"L‚Äôessentiel est invisible pour les yeux.",a:"Antoine de Saint-Exup√©ry"}
];

// relations
const RELATIONS={
"1":{label:"M√àRE",color:"#ff85a1", msg:n=>`Maman ${n}, tu es ma fondation. Ton amour est mon code infaillible. üíó`},
"2":{label:"P√àRE",color:"#00d4ff", msg:n=>`Papa ${n}, merci d'√™tre mon guide. Tu es le processeur de ma vie. ü§ç`},
"3":{label:"AMOUREUX",color:"#ff3131", msg:n=>`${n}, mon amour, tu es ma plus belle ligne de destin. ‚ù§Ô∏è`},
"4":{label:"AMI",color:"#00ff41", msg:n=>`
${userName}‚Ä¶

Tout a commenc√© √† ${meetingPlace}.
Depuis, tu es rest√© indispensable.
Le monde peut changer, pas notre lien. üíö`
},
"5":{label:"FRATRIE",color:"#ffcc00", msg:n=>`${userName}, complice de toujours. Notre lien est grav√© dans la m√©moire. üíõ`}
};

// machine √† √©crire
function write(text,error=false){
 return new Promise(res=>{
  const line=document.createElement("div");
  if(error)line.className="error";
  output.appendChild(line);
  let i=0;
  const t=setInterval(()=>{
   line.textContent+=text[i++]||"";
   if(i>text.length){clearInterval(t);window.scrollTo(0,document.body.scrollHeight);res();}
  },30);
 });
}

function typeMessage(el,text,speed=28){
 let i=0;el.innerHTML="";
 const t=setInterval(()=>{
  el.innerHTML+=text.charAt(i++);
  if(i>=text.length){clearInterval(t);el.classList.add("pulse")}
 },speed);
}

// gestion des √©tapes
userInput.addEventListener("keydown",async e=>{
 if(e.key!=="Enter")return;
 const v=userInput.value.trim();userInput.value="";
 inputArea.classList.add("hidden");

 if(step==="NAME"){
  userName=v||"Invit√©";
  await write("> NOM ENREGISTR√â");
  await write("CHOISIR RELATION (1-5) :");
  step="RELATION";
 }
 else if(step==="RELATION"){
  if(!RELATIONS[v]) await write("CHOIX INVALIDE",true);
  else{
   selectedRelation=RELATIONS[v];
   if(v==="4"){step="MEET"; await write("O√ô NOUS SOMMES-NOUS RENCONTR√âS ?");}
   else{step="CODE"; await write("ENTRER MON ANN√âE DE NAISSANCE :");}
  }
 }
 else if(step==="MEET"){
  meetingPlace=v||"un endroit inoubliable";
  step="CODE";
  await write("ENTRER MON ANN√âE DE NAISSANCE :");
 }
 else if(step==="CODE"){
  if(v==="2002"){setTimeout(reveal,800);return;}
  else await write("CODE ERRON√â",true);
 }
 inputArea.classList.remove("hidden");
 userInput.focus();
});

// affichage final
function reveal(){
 document.getElementById("terminal").style.display="none";
 document.documentElement.style.setProperty("--accent",selectedRelation.color);
 finalScreen.style.display="flex";

 const quote=random(QUOTES);
 document.getElementById("quote-text").textContent=quote.q;
 document.getElementById("quote-author").textContent=quote.a;

 setTimeout(()=>{
  finalScreen.style.opacity=1;
  typeMessage(document.getElementById("custom-message"),selectedRelation.msg(userName).trim());
 },300);
}

function celebrate(){
 confetti({particleCount:120,spread:90});
}

// lancement
write("INITIALISATION DU SYST√àME...").then(()=>{
 write("VOTRE NOM :").then(()=>{
  inputArea.classList.remove("hidden");
  userInput.focus();
 });
});
</script>
</body>
</html>
