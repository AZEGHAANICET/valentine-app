<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VALENTINE_TERMINAL</title>

<style>
:root {
    --terminal-green:#00ff41;
    --terminal-bg:#050b05;
    --terminal-red:#ff3131;
    --accent:var(--terminal-green);
}
*{box-sizing:border-box}
html,body{
    background:var(--terminal-bg);
    color:var(--accent);
    font-family:"Courier New",monospace;
    margin:0;height:100%;
}
.scanlines{
    position:fixed;inset:0;
    background:linear-gradient(rgba(0,0,0,0) 50%,rgba(0,0,0,.12) 50%);
    background-size:100% 3px;
    pointer-events:none;
}
#terminal{
    padding:20px;
    font-size:16px;
    text-shadow:0 0 5px var(--accent);
}
.input-line{display:flex;margin-top:15px}
#user-input{
    background:transparent;border:none;color:#fff;
    font-family:inherit;outline:none;width:100%;
}
.cursor{
    width:8px;background:var(--accent);
    animation:blink .8s infinite;
}
@keyframes blink{50%{opacity:0}}
.hidden{display:none}
.error{color:var(--terminal-red)}

#final-screen{
    display:none;position:fixed;inset:0;
    background:#000;justify-content:center;
    align-items:center;flex-direction:column;
    text-align:center;opacity:0;
    transition:opacity 1s;
}
.heart-ascii{
    color:var(--terminal-red);
    white-space:pre;font-size:8px;
}
#custom-message{
    color:#eee;
    margin:25px;
    font-size:1.15rem;
    line-height:1.7;
}
.btn{
    background:transparent;
    border:1px solid #ff4d6d;
    color:white;padding:12px 30px;
    cursor:pointer;
}
</style>
</head>

<body>
<div class="scanlines"></div>

<div id="terminal" onclick="userInput.focus()">
    <div id="output"></div>
    <div id="input-area" class="input-line hidden">
        <span>> </span>
        <input id="user-input" autocomplete="off">
        <span class="cursor"></span>
    </div>
</div>

<div id="final-screen">
<div class="heart-ascii">
*** ***
******* *******
*****************
*****************
 ***************
   ***********
     *******
       ***
        *
</div>
<div id="custom-message"></div>
<button class="btn" onclick="celebrate()">[ ‚ù§Ô∏è ]</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

<script>
const output=document.getElementById("output");
const userInput=document.getElementById("user-input");
const inputArea=document.getElementById("input-area");
const finalScreen=document.getElementById("final-screen");

let step="NAME";
let userName="";
let selectedRelation=null;
let meetingPlace="";

const random=a=>a[Math.floor(Math.random()*a.length)];

const RELATIONS={
"1":{
 label:"M√àRE",color:"#ff85a1",
 msg:n=>`
Maman ${n}‚Ä¶

Tu es le point de d√©part.
La premi√®re chaleur.
La seule constante quand tout vacille.

Si le monde est un chaos,
ton amour est ma base stable.

Je t‚Äôaime. Toujours. üíó`
},
"2":{
 label:"P√àRE",color:"#00d4ff",
 msg:n=>`
Papa ${n}‚Ä¶

Tu m‚Äôas appris √† tenir droit,
m√™me quand le vent pousse fort.

Je n‚Äôai peut-√™tre jamais tout dit,
mais je marche avec ce que tu m‚Äôas transmis.

Merci. ü§ç`
},
"3":{
 label:"AMOUR",color:"#ff3131",
 msg:n=>`
${n}‚Ä¶

Il y a des gens qu‚Äôon croise.
Et puis il y a toi.

Mon c≈ìur te reconna√Æt
avant m√™me que je comprenne pourquoi.

Si aimer est un risque,
alors je signe sans lire les conditions. ‚ù§Ô∏è`
},
"4":{
 label:"AMI",color:"#00ff41",
 msg:n=>{
 const intros=[
 `${n}‚Ä¶`,
 `√âcoute-moi ${n}.`,
 `${n}, pause une seconde.`,
 `Tu sais quoi ${n} ?`
 ];
 const memories=[
 `Tout a commenc√© √† ${meetingPlace}.`,
 `Je repense souvent √† ${meetingPlace}.`,
 `${meetingPlace}. Comme si c‚Äô√©tait √©crit.`,
 `Un lieu banal‚Ä¶ sauf pour nous : ${meetingPlace}.`
 ];
 const cores=[
 `Sans faire de bruit, t‚Äôes devenu essentiel.`,
 `Depuis ce jour, t‚Äôas jamais quitt√© le syst√®me.`,
 `Et sans pr√©venir‚Ä¶ t‚Äô√©tais toujours l√†.`,
 `Le temps a pass√©, pas notre lien.`
 ];
 const endings=[
 `T‚Äôes une valeur s√ªre.`,
 `Peu de gens m√©ritent ce statut.`,
 `Le monde peut buguer, pas nous.`,
 `Rien √† prouver. Tout est l√†.`
 ];
 return `
${random(intros)}

${random(memories)}

${random(cores)}

${random(endings)} üíö
 `;
 }
},
"5":{
 label:"FRATRIE",color:"#ffcc00",
 msg:n=>`
${n}‚Ä¶

On ne s‚Äôest pas choisis,
mais on s‚Äôest construits ensemble.

M√™me quand tout change,
toi tu restes.

Lien syst√®me.
Version d√©finitive. üíõ`
}
};

function write(text,error=false){
 return new Promise(res=>{
  const line=document.createElement("div");
  if(error)line.className="error";
  output.appendChild(line);
  let i=0;
  const t=setInterval(()=>{
   line.textContent+=text[i++]||"";
   if(i>text.length){
    clearInterval(t);
    window.scrollTo(0,document.body.scrollHeight);
    res();
   }
  },30);
 });
}

userInput.addEventListener("keydown",async e=>{
 if(e.key!=="Enter")return;
 const val=userInput.value.trim();
 userInput.value="";
 inputArea.classList.add("hidden");

 if(step==="NAME"){
  userName=val||"Invit√©";
  await write("> NOM : "+userName.toUpperCase());
  await write("QUELLE EST VOTRE RELATION ?");
  await write("1. M√àRE | 2. P√àRE | 3. AMOUR");
  await write("4. AMI(E) | 5. FRATRIE");
  step="RELATION";
 }
 else if(step==="RELATION"){
  if(!RELATIONS[val]) await write("CHOIX INVALIDE.",true);
  else{
   selectedRelation=RELATIONS[val];
   await write("> OPTION VALID√âE");
   if(val==="4"){
    step="MEET_PLACE";
    await write("O√ô NOUS SOMMES-NOUS RENCONTR√âS ?");
   }else{
    step="CODE";
    await write("ENTRER MON ANN√âE DE NAISSANCE :");
   }
  }
 }
 else if(step==="MEET_PLACE"){
  meetingPlace=val||"un endroit inoubliable";
  await write("> SOUVENIR ENREGISTR√â");
  step="CODE";
  await write("ENTRER MON ANN√âE DE NAISSANCE :");
 }
 else if(step==="CODE"){
  if(val==="2002"){
   await write("ACC√àS ACCORD√â...");
   setTimeout(reveal,900);return;
  }else await write("CODE ERRON√â.",true);
 }

 inputArea.classList.remove("hidden");
 userInput.focus();
});

function reveal(){
 document.getElementById("terminal").style.display="none";
 document.documentElement.style.setProperty("--accent",selectedRelation.color);
 document.getElementById("custom-message").innerText=
  selectedRelation.msg(userName);
 finalScreen.style.display="flex";
 setTimeout(()=>finalScreen.style.opacity=1,50);
}
function celebrate(){
 confetti({particleCount:120,spread:80});
}

write("INITIALISATION DU SYST√àME...").then(()=>{
 write("VOTRE NOM :").then(()=>{
  inputArea.classList.remove("hidden");
  userInput.focus();
 });
});
</script>
</body>
</html>
